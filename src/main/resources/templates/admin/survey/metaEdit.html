<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>설문 생성/수정</title>

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" th:href="@{/css/admin.css}">
</head>
<body>

<div th:replace="~{admin/adminLeft :: sidebar}"></div>

<main class="admin-content">

  <button class="btn btn-outline-secondary d-lg-none mb-3" onclick="toggleSidebar()">☰ 메뉴</button>

  <!-- Header -->
  <div class="mb-4">
    <h3 class="fw-bold" th:text="${meta.id} != null ? '설문 수정' : '새 설문 추가'"></h3>
    <small class="text-secondary">설문 제목을 입력하세요.</small>
  </div>

  <div class="card shadow-sm p-4" style="max-width:700px;">

    <form th:action="@{/admin/survey/meta/save}" method="post">

      <input type="hidden" name="id" th:value="${meta.id}"/>

      <div class="mb-3">
        <label class="form-label">설문 제목</label>
        <input type="text" class="form-control"
               name="title"
               placeholder="예) 2025 고객만족도 조사"
               th:value="${meta.title}">
      </div>

      <div class="mb-3">
        <label class="form-label">설문 설명</label>
        <textarea class="form-control"
                  name="description"
                  rows="3"
                  placeholder="설문에 대한 설명을 입력하세요 (예: 고객 만족도 향상을 위한 조사입니다)"
                  th:text="${meta.description}"></textarea>
      </div>

      <!-- End Date -->
      <div class="mb-3">
        <label class="form-label">설문 종료일</label>
        <input type="datetime-local"
               th:value="${meta.endDate != null ? #temporals.format(meta.endDate, 'yyyy-MM-dd''T''HH:mm') : ''}">
        <small class="text-muted">종료일이 지나면 자동 비활성됩니다.</small>
      </div>

      <hr>

      <div class="d-flex gap-2">
        <button class="btn btn-primary" type="submit">저장</button>

        <a th:href="@{/admin/survey}" class="btn btn-secondary">
          취소
        </a>

        <!-- 삭제 버튼 (수정일 경우만 보임) -->
        <form th:if="${meta.id != null}"
              th:action="@{'/admin/survey/meta/delete/' + ${meta.id}}"
              method="post"
              onsubmit="return confirm('삭제하시겠습니까?');">
          <button class="btn btn-danger" type="submit">삭제</button>
        </form>
      </div>

    </form>
  </div>

</main>

<script>
  function toggleSidebar() {
    document.querySelector('.admin-sidebar').classList.toggle('active');
  }
</script>

</body>
</html>
